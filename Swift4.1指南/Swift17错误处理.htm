<!DOCTYPE html>
<!-- saved from url=(0162)https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#//apple_ref/doc/uid/TP40014097-CH42-ID508 -->
<html lang="en" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">  
  <title>The Swift Programming Language (Swift 4.1): Error Handling</title>
  <link rel="stylesheet" type="text/css" href="./The Swift Programming Language (Swift 4.1)_错误处理_files/style-1.6.3.css">
  <link rel="stylesheet" type="text/css" href="./The Swift Programming Language (Swift 4.1)_错误处理_files/feedback-1.6.3.css">
   
<meta id="j-version" name="j-version" content="">
<meta id="build" name="build" content="2cff7ac52859143a0b42c92c22d84718">
<meta id="document-version" name="document-version" content="10.3.3">
<meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Topic/Swift}">
<meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/TP40014097">
<meta id="chapterId" name="chapterId" content="TP40014097-CH42">
<meta id="book-title" name="book-title" content="The Swift Programming Language (Swift 4.1)">
<meta id="book-resource-type" name="book-resource-type" content="Guide">
<meta id="book-root" name="book-root" content="./">
<meta id="book-json" name="book-json" content="book.json">
<meta id="date" name="date" content="2018-02-20">
<meta id="description" name="description" content="The definitive guide to Swift, Apple’s programming language for building iOS, macOS, watchOS, and tvOS apps.">
<meta id="IndexTitle" name="IndexTitle" content="">
<meta id="resources-uri" name="resources-uri" content="../../../../Resources/1277">
<link id="book-index-page" rel="Start" title="" type="text/html" href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/index.html">
<!-- , next_chapter: next_chapter, previous_chapter: previous_chapter -->
<link id="next-page" rel="Next" type="text/html" href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html">
<link id="previous-page" rel="Prev" type="text/html" href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html">
<meta id="devcenter" name="devcenter" content="&lt;!-- DEVCENTER_NAME --&gt;">
<meta id="devcenter-url" name="devcenter-url" content="&lt;!-- DEVCENTER_URL --&gt;">
<meta id="reflib" name="reflib" content="&lt;!-- REFLIB_NAME --&gt;">

<meta id="xcode-display" name="xcode-display" content="render">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta id="platforms" name="platforms" content="Xcode Developer Tools">
<link type="text/css" rel="stylesheet" charset="UTF-8" href="./The Swift Programming Language (Swift 4.1)_错误处理_files/translateelement.css"></head>

  <body id="conceptual_flow_with_tasks" class="jazz">
    
    <header id="ios_header" class="hideOnPrint hideInXcode">
  <div class="content-wrapper">
    <p class="header-text">
    	<a href="https://developer.apple.com/library/content/navigation/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指南和示例代码
 		</font></font></a>
 </p>
    <p id="wwdr"><img id="apple_logo" src="./The Swift Programming Language (Swift 4.1)_错误处理_files/apple2.png" height="14px" width="12px" aria-hidden="true"><a href="https://developer.apple.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发人员</font></font></a></p>
  </div>
</header>

    <section id="valence">
  <div class="content-wrapper">
    <p id="hierarchial_navigation">
      <span id="book_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift编程语言（Swift 4.1）</font></font></span>
    </p>
    <form id="search" class="hideInXcode" method="get" action="https://developer.apple.com/search/index.php" accept-charset="utf-8" autocomplete="off">
  <input type="search" id="ssi_SearchField" placeholder="Search Guides and Sample Code" name="q" autocomplete="off" tabindex="2">
</form>

      
   
   




    <span class="download-text hideInXcode">
      <a href="https://itunes.apple.com/us/book/the-swift-programming-language/id1002622538?mt=11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的iBooks</font></font></a>
    </span>

    

    <img id="shortstack" src="./The Swift Programming Language (Swift 4.1)_错误处理_files/shortstack_2x.png">
  </div>
</section>
    <div class="content-wrapper">
      <nav id="navigator" class="book-parts hideInXcode" role="navigation">
    <ul class="nav-parts">
        <li data-id="//apple_ref/doc/uid/TP40014097-CH1-ID2" class="part-name">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/index.html#//apple_ref/doc/uid/TP40014097-CH3-ID0" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH3-ID0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">欢迎来到Swift</font></font></a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/index.html#//apple_ref/doc/uid/TP40014097-CH3-ID0" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH3-ID0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于Swift</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Compatibility.html#//apple_ref/doc/uid/TP40014097-CH45-ID561" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH45-ID561"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本兼容性</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/GuidedTour.html#//apple_ref/doc/uid/TP40014097-CH2-ID1" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH2-ID1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快速游览</font></font></a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40014097-CH4-ID233" class="part-name nav-part-active open-part">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID309" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH5-ID309"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语言指南</font></font></a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID309" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH5-ID309"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基础</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/BasicOperators.html#//apple_ref/doc/uid/TP40014097-CH6-ID60" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH6-ID60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">基本操作员</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/StringsAndCharacters.html#//apple_ref/doc/uid/TP40014097-CH7-ID285" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH7-ID285"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">字符串和字符</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/CollectionTypes.html#//apple_ref/doc/uid/TP40014097-CH8-ID105" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH8-ID105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">集合类型</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ControlFlow.html#//apple_ref/doc/uid/TP40014097-CH9-ID120" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH9-ID120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">控制流</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Functions.html#//apple_ref/doc/uid/TP40014097-CH10-ID158" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH10-ID158"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Closures.html#//apple_ref/doc/uid/TP40014097-CH11-ID94" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH11-ID94"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关闭</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Enumerations.html#//apple_ref/doc/uid/TP40014097-CH12-ID145" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH12-ID145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ClassesAndStructures.html#//apple_ref/doc/uid/TP40014097-CH13-ID82" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH13-ID82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类和结构</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Properties.html#//apple_ref/doc/uid/TP40014097-CH14-ID254" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH14-ID254"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Methods.html#//apple_ref/doc/uid/TP40014097-CH15-ID234" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH15-ID234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Subscripts.html#//apple_ref/doc/uid/TP40014097-CH16-ID305" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH16-ID305"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Inheritance.html#//apple_ref/doc/uid/TP40014097-CH17-ID193" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH17-ID193"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">遗产</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Initialization.html#//apple_ref/doc/uid/TP40014097-CH18-ID203" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH18-ID203"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">初始化</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Deinitialization.html#//apple_ref/doc/uid/TP40014097-CH19-ID142" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH19-ID142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反初始化</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/OptionalChaining.html#//apple_ref/doc/uid/TP40014097-CH21-ID245" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH21-ID245"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可选链接</font></font></a>
              </li>
              <li class="nav-chapter nav-current-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#//apple_ref/doc/uid/TP40014097-CH42-ID508" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH42-ID508"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误处理</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/TypeCasting.html#//apple_ref/doc/uid/TP40014097-CH22-ID338" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH22-ID338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型铸造</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/NestedTypes.html#//apple_ref/doc/uid/TP40014097-CH23-ID242" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH23-ID242"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嵌套类型</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Extensions.html#//apple_ref/doc/uid/TP40014097-CH24-ID151" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH24-ID151"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">扩展</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Protocols.html#//apple_ref/doc/uid/TP40014097-CH25-ID267" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH25-ID267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Generics.html#//apple_ref/doc/uid/TP40014097-CH26-ID179" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH26-ID179"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">泛型</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AutomaticReferenceCounting.html#//apple_ref/doc/uid/TP40014097-CH20-ID48" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH20-ID48"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动引用计数</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/MemorySafety.html#//apple_ref/doc/uid/TP40014097-CH46-ID567" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH46-ID567"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">内存安全</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AccessControl.html#//apple_ref/doc/uid/TP40014097-CH41-ID3" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH41-ID3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">访问控制</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AdvancedOperators.html#//apple_ref/doc/uid/TP40014097-CH27-ID28" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH27-ID28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">高级操作员</font></font></a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40014097-CH28-ID427" class="part-name">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AboutTheLanguageReference.html#//apple_ref/doc/uid/TP40014097-CH29-ID345" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH29-ID345"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语言参考</font></font></a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AboutTheLanguageReference.html#//apple_ref/doc/uid/TP40014097-CH29-ID345" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH29-ID345"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于语言参考</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/LexicalStructure.html#//apple_ref/doc/uid/TP40014097-CH30-ID410" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH30-ID410"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">词汇结构</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Types.html#//apple_ref/doc/uid/TP40014097-CH31-ID445" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH31-ID445"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Expressions.html#//apple_ref/doc/uid/TP40014097-CH32-ID383" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH32-ID383"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Statements.html#//apple_ref/doc/uid/TP40014097-CH33-ID428" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH33-ID428"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Declarations.html#//apple_ref/doc/uid/TP40014097-CH34-ID351" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH34-ID351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Attributes.html#//apple_ref/doc/uid/TP40014097-CH35-ID347" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH35-ID347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Patterns.html#//apple_ref/doc/uid/TP40014097-CH36-ID419" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH36-ID419"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/GenericParametersAndArguments.html#//apple_ref/doc/uid/TP40014097-CH37-ID406" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH37-ID406"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通用参数和参数</font></font></a>
              </li>
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/zzSummaryOfTheGrammar.html#//apple_ref/doc/uid/TP40014097-CH38-ID458" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH38-ID458"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法概要</font></font></a>
              </li>
          </ul>
        </li>
        <li data-id="//apple_ref/doc/uid/TP40014097-CH39-ID460" class="part-name">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/RevisionHistory.html#//apple_ref/doc/uid/TP40014097-CH40-ID459" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH40-ID459"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修订记录</font></font></a>
          <ul class="nav-chapters">
              <li class="nav-chapter">
              	<a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/RevisionHistory.html#//apple_ref/doc/uid/TP40014097-CH40-ID459" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH40-ID459"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档修订历史</font></font></a>
              </li>
          </ul>
        </li>
    </ul>
</nav>

      <menu id="bashful" type="toolbar">
  <div class="shield"></div>
  <menuitem id="jump_to" class="menu-bar-item closed">
  <span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在本页</font></font></span>
  <div class="chevron">
    <div class="chevy chevron-left"></div>
    <div class="chevy chevron-right"></div>
  </div>
  <menu type="list" class="details">
      <ul class="list-bullet">
          <li class="item">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#//apple_ref/doc/uid/TP40014097-CH42-ID509">Representing and Throwing Errors</a>
          </li>
          <li class="item">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#//apple_ref/doc/uid/TP40014097-CH42-ID512">Handling Errors</a>
          </li>
          <li class="item">
            <a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#//apple_ref/doc/uid/TP40014097-CH42-ID514">Specifying Cleanup Actions</a>
          </li>
      </ul>
  </menu>
</menuitem>

</menu>
<div class="pixel-line"></div>
<div class="rubber-band-gap"></div>
<article class="chapter">
  <a name="//apple_ref/doc/uid/TP40014097-CH42"></a><a name="//apple_ref/doc/uid/TP40014097-CH42-ID508"></a>

  <h2 class="chapter-name"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误处理</font></font></h2>


  
  	<section class="section">
  		<p class="para">
  <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误处理</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是对程序中的错误条件进行响应和恢复的过程。</font><font style="vertical-align: inherit;">Swift在运行时为抛出，捕获，传播和处理可恢复错误提供了一流的支持。
</font></font></p>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  某些操作不能保证始终完成执行或产生有用的输出。</font><font style="vertical-align: inherit;">可选项用于表示没有值，但是当操作失败时，了解导致失败的原因通常很有用，以便您的代码可以做出相应的响应。
</font></font></p>
<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  作为例子，考虑从磁盘上的文件读取和处理数据的任务。</font><font style="vertical-align: inherit;">此任务可能有多种失败方式，包括文件不存在于指定路径，文件没有读取权限，或文件未以兼容格式编码。</font><font style="vertical-align: inherit;">通过区分这些不同的情况，程序可以解决一些错误，并向用户传达它无法解决的任何错误。
</font></font></p>
<div class="note">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-NoLink_154"></a>
  <aside class="aside">
    <p class="aside-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意
    </font></font></p>
    	<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift中的错误处理与使用</font></font><code class="code-voice">NSError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cocoa和Objective-C中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">类的</font><font style="vertical-align: inherit;">错误处理模式进行交互操作</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关此类的更多信息，请参阅</font><font style="vertical-align: inherit;">在</font><em class="u-book"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/index.html#//apple_ref/doc/uid/TP40014216" data-renderer-version="2" target="_self"><font style="vertical-align: inherit;">Cocoa和Objective-C</font></a></em><font style="vertical-align: inherit;">中</font><em class="u-book"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/index.html#//apple_ref/doc/uid/TP40014216" data-renderer-version="2" target="_self"><font style="vertical-align: inherit;">使用Swift中的</font></a></em></font><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/AdoptingCocoaDesignPatterns.html#//apple_ref/doc/uid/TP40014216-CH7-ID10" data-renderer-version="2" target="_self"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误处理</font></font></a><font style="vertical-align: inherit;"></font><em class="u-book"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/index.html#//apple_ref/doc/uid/TP40014216" data-renderer-version="2" target="_self"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（Swift 4.1）</font></font></a></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    	</font></font></p>
    
  </aside>
</div>

		</section> 


  <section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID509"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">代表和投掷错误</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在Swift中，错误由符合</font></font><code class="code-voice">Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协议</font><font style="vertical-align: inherit;">的类型值表示</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这个空协议表明一个类型可以用于错误处理。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  Swift枚举特别适合于模拟一组相关的错误条件，并且相关的值允许提供有关错误性质的附加信息。</font><font style="vertical-align: inherit;">例如，下面是您如何表示在游戏中操作自动售货机的错误条件：
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">enum</span> <span class="vc">VendingMachineError</span>: <span class="n"><!-- a href="" -->Error<!-- /a --></span> {</code></li>
            <li><code class="code-voice">    <span class="kt">case</span> <span class="vc">invalidSelection</span></code></li>
            <li><code class="code-voice">    <span class="kt">case</span> <span class="vc">insufficientFunds</span>(<span class="vc">coinsNeeded</span>: <span class="vc">Int</span>)</code></li>
            <li><code class="code-voice">    <span class="kt">case</span> <span class="vc">outOfStock</span></code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  抛出一个错误可以让你指出意外事件发生，并且正常的执行流程无法继续。</font><font style="vertical-align: inherit;">您使用</font></font><code class="code-voice">throw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来引发错误。</font><font style="vertical-align: inherit;">例如，下面的代码会抛出一个错误，指出自动售货机需要五个额外的硬币：
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">throw</span> <span class="vc">VendingMachineError</span>.<span class="vc">insufficientFunds</span>(<span class="vc">coinsNeeded</span>: <span class="m">5</span>)</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID512"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理错误</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  当引发错误时，一些代码必须负责处理错误 - 例如，纠正问题，尝试替代方法或通知用户错误。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  有四种方法可以处理Swift中的错误。</font><font style="vertical-align: inherit;">您可以将错误从函数传播到调用该函数的代码，使用</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句处理错误，将错误作为可选值处理或者声明错误不会发生。</font><font style="vertical-align: inherit;">下面将介绍每种方法。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  当一个函数抛出一个错误时，它会改变程序的流程，所以重要的是你可以在代码中快速识别可能抛出错误的地方。</font><font style="vertical-align: inherit;">要在您的代码中标识这些位置，请</font><font style="vertical-align: inherit;">在调用可能会引发错误的函数，方法或初始值设定项的代码之前</font><font style="vertical-align: inherit;">写入</font></font><code class="code-voice">try</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字</font></font><code class="code-voice">try?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="code-voice">try!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">变体。</font><font style="vertical-align: inherit;">这些关键字将在下面的章节中介绍。
</font></font></p><div class="note">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-NoLink_155"></a>
  <aside class="aside">
    <p class="aside-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意
    </font></font></p>
    	<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在斯威夫特的错误处理类似的异常处理在其他语言中，使用了的</font></font><code class="code-voice">try</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="code-voice">throw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字。</font><font style="vertical-align: inherit;">与许多语言中的异常处理不同 - 包括Swift中的Objective-C错误处理不涉及展开调用堆栈，这是一个计算成本很高的过程。</font><font style="vertical-align: inherit;">因此，</font></font><code class="code-voice">throw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font><font style="vertical-align: inherit;">的表现特征与</font><font style="vertical-align: inherit;">声明</font><font style="vertical-align: inherit;">的表现特征</font><font style="vertical-align: inherit;">相当</font></font><code class="code-voice">return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
    	</font></font></p>
    
  </aside>
</div>
  <section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID510"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用投掷函数传播错误</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  为了表明函数，方法或初始值设定项可以引发错误，可以</font></font><code class="code-voice">throws</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在函数的声明后面</font><font style="vertical-align: inherit;">写入</font><font style="vertical-align: inherit;">关键字。</font><font style="vertical-align: inherit;">标</font></font><code class="code-voice">throws</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">称为</font><em><font style="vertical-align: inherit;">投掷功能</font></em><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果函数指定返回类型，则</font></font><code class="code-voice">throws</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在返回箭头（</font></font><code class="code-voice">-&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font><font style="vertical-align: inherit;">之前</font><font style="vertical-align: inherit;">写入</font><font style="vertical-align: inherit;">关键字</font><font style="vertical-align: inherit;">。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">canThrowErrors</span>() <span class="kt">throws</span> -&gt; <span class="n"><!-- a href="" -->String<!-- /a --></span></code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">cannotThrowErrors</span>() -&gt; <span class="n"><!-- a href="" -->String<!-- /a --></span></code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  抛出函数将抛出的错误传播给它所调用的作用域。
</font></font></p><div class="note">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-NoLink_156"></a>
  <aside class="aside">
    <p class="aside-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意
    </font></font></p>
    	<p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只有引发函数会传播错误。</font><font style="vertical-align: inherit;">任何在非抛出函数内抛出的错误都必须在函数内部处理。
    	</font></font></p>
    
  </aside>
</div><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在下面的示例中，</font><font style="vertical-align: inherit;">如果请求的商品不可用，缺货或成本超过当前存款金额</font><font style="vertical-align: inherit;">，则</font></font><code class="code-voice">VendingMachine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该类有一个</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适当</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">方法</font></font><code class="code-voice">VendingMachineError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">struct</span> <span class="vc">Item</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">var</span> <span class="vc">price</span>: <span class="n"><!-- a href="" -->Int<!-- /a --></span></code></li>
            <li><code class="code-voice">    <span class="kt">var</span> <span class="vc">count</span>: <span class="n"><!-- a href="" -->Int<!-- /a --></span></code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice"><span class="kt">class</span> <span class="vc">VendingMachine</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">var</span> <span class="vc">inventory</span> = [</code></li>
            <li><code class="code-voice">        <span class="s">"Candy Bar"</span>: <span class="vc">Item</span>(<span class="vc">price</span>: <span class="m">12</span>, <span class="vc">count</span>: <span class="m">7</span>),</code></li>
            <li><code class="code-voice">        <span class="s">"Chips"</span>: <span class="vc">Item</span>(<span class="vc">price</span>: <span class="m">10</span>, <span class="vc">count</span>: <span class="m">4</span>),</code></li>
            <li><code class="code-voice">        <span class="s">"Pretzels"</span>: <span class="vc">Item</span>(<span class="vc">price</span>: <span class="m">7</span>, <span class="vc">count</span>: <span class="m">11</span>)</code></li>
            <li><code class="code-voice">    ]</code></li>
            <li><code class="code-voice">    <span class="kt">var</span> <span class="vc">coinsDeposited</span> = <span class="m">0</span></code></li>
            <li><code class="code-voice">    </code></li>
            <li><code class="code-voice">    <span class="kt">func</span> <span class="vc">vend</span>(<span class="vc">itemNamed</span> <span class="vc">name</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span>) <span class="kt">throws</span> {</code></li>
            <li><code class="code-voice">        <span class="kt">guard</span> <span class="kt">let</span> <span class="vc">item</span> = <span class="vc">inventory</span>[<span class="vc">name</span>] <span class="kt">else</span> {</code></li>
            <li><code class="code-voice">            <span class="kt">throw</span> <span class="vc">VendingMachineError</span>.<span class="vc">invalidSelection</span></code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        </code></li>
            <li><code class="code-voice">        <span class="kt">guard</span> <span class="vc">item</span>.<span class="vc">count</span> &gt; <span class="m">0</span> <span class="kt">else</span> {</code></li>
            <li><code class="code-voice">            <span class="kt">throw</span> <span class="vc">VendingMachineError</span>.<span class="vc">outOfStock</span></code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        </code></li>
            <li><code class="code-voice">        <span class="kt">guard</span> <span class="vc">item</span>.<span class="vc">price</span> &lt;= <span class="vc">coinsDeposited</span> <span class="kt">else</span> {</code></li>
            <li><code class="code-voice">            <span class="kt">throw</span> <span class="vc">VendingMachineError</span>.<span class="vc">insufficientFunds</span>(<span class="vc">coinsNeeded</span>: <span class="vc">item</span>.<span class="vc">price</span> - <span class="vc">coinsDeposited</span>)</code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        </code></li>
            <li><code class="code-voice">        <span class="vc">coinsDeposited</span> -= <span class="vc">item</span>.<span class="vc">price</span></code></li>
            <li><code class="code-voice">        </code></li>
            <li><code class="code-voice">        <span class="kt">var</span> <span class="vc">newItem</span> = <span class="vc">item</span></code></li>
            <li><code class="code-voice">        <span class="vc">newItem</span>.<span class="vc">count</span> -= <span class="m">1</span></code></li>
            <li><code class="code-voice">        <span class="vc">inventory</span>[<span class="vc">name</span>] = <span class="vc">newItem</span></code></li>
            <li><code class="code-voice">        </code></li>
            <li><code class="code-voice">        <span class="vc">print</span>(<span class="s">"Dispensing </span>\(<span class="vc">name</span>)<span class="s">"</span>)</code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  该</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">的实施</font><font style="vertical-align: inherit;">使用</font></font><code class="code-voice">guard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来提前退出该方法，并且如果没有满足购买零食的任何要求则抛出适当的错误。</font><font style="vertical-align: inherit;">由于</font></font><code class="code-voice">throw</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明立即转移程序控制，所以只有满足所有这些要求时才会出售物品。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  因为该</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法会传播任何错误，所以调用此方法的任何代码都必须处理错误 - 使用</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句</font></font><code class="code-voice">try?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或</font></font><code class="code-voice">try!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- 或继续传播它们。</font><font style="vertical-align: inherit;">例如，</font></font><code class="code-voice">buyFavoriteSnack(person:vendingMachine:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在下面的例子中也是一个抛出函数，并且该</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法抛出的</font><font style="vertical-align: inherit;">任何错误</font><font style="vertical-align: inherit;">都会传播到该</font></font><code class="code-voice">buyFavoriteSnack(person:vendingMachine:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数被调用的地方。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">let</span> <span class="vc">favoriteSnacks</span> = [</code></li>
            <li><code class="code-voice">    <span class="s">"Alice"</span>: <span class="s">"Chips"</span>,</code></li>
            <li><code class="code-voice">    <span class="s">"Bob"</span>: <span class="s">"Licorice"</span>,</code></li>
            <li><code class="code-voice">    <span class="s">"Eve"</span>: <span class="s">"Pretzels"</span>,</code></li>
            <li><code class="code-voice">]</code></li>
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">buyFavoriteSnack</span>(<span class="vc">person</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span>, <span class="vc">vendingMachine</span>: <span class="n"><!-- a href="" -->VendingMachine<!-- /a --></span>) <span class="kt">throws</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">let</span> <span class="vc">snackName</span> = <span class="vc">favoriteSnacks</span>[<span class="vc">person</span>] ?? <span class="s">"Candy Bar"</span></code></li>
            <li><code class="code-voice">    <span class="kt">try</span> <span class="vc">vendingMachine</span>.<span class="vc">vend</span>(<span class="vc">itemNamed</span>: <span class="vc">snackName</span>)</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在这个例子中，</font></font><code class="code-voice">buyFavoriteSnack(person: vendingMachine:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数查找给定人最喜欢的零食，并尝试通过调用该</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">为他们购买</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">由于该</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法可能会引发错误，因此会使用</font></font><code class="code-voice">try</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前面</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">关键字</font><font style="vertical-align: inherit;">调用</font><font style="vertical-align: inherit;">该</font><font style="vertical-align: inherit;">方法</font><font style="vertical-align: inherit;">。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  抛出初始化器可以像抛出函数一样传播错误。</font><font style="vertical-align: inherit;">例如，</font></font><code class="code-voice">PurchasedSnack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下面列表中</font><font style="vertical-align: inherit;">的</font><font style="vertical-align: inherit;">结构初始化程序将初始化过程的一部分调用throwing函数，并通过将它传播给调用者来处理它遇到的任何错误。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">struct</span> <span class="vc">PurchasedSnack</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">let</span> <span class="vc">name</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span></code></li>
            <li><code class="code-voice">    <span class="kt">init</span>(<span class="vc">name</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span>, <span class="vc">vendingMachine</span>: <span class="n"><!-- a href="" -->VendingMachine<!-- /a --></span>) <span class="kt">throws</span> {</code></li>
            <li><code class="code-voice">        <span class="kt">try</span> <span class="vc">vendingMachine</span>.<span class="vc">vend</span>(<span class="vc">itemNamed</span>: <span class="vc">name</span>)</code></li>
            <li><code class="code-voice">        <span class="kt">self</span>.<span class="vc">name</span> = <span class="vc">name</span></code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID541"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Do-Catch处理错误</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  您使用</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句通过运行一段代码来处理错误。</font><font style="vertical-align: inherit;">如果该</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句中</font><font style="vertical-align: inherit;">的代码引发错误</font><font style="vertical-align: inherit;">，则将其与</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句进行</font><font style="vertical-align: inherit;">匹配</font><font style="vertical-align: inherit;">以确定哪个子句可以处理该错误。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  这里是一个的一般形式</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句：
</font></font></p><span class="caption"></span>
<div class="code-outline">
  <ul class="code-outline-lines">
    <li><pre class="code-voice"><span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">做</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></pre></li><li><pre class="code-voice">    <span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尝试</font></font></span> <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达</font></font></em></pre></li><li><pre class="code-voice">    <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></em></pre></li><li><pre class="code-voice"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">} </font></font><span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch </font></font></span> <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pattern 1</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></pre></li><li><pre class="code-voice">    <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></em></pre></li><li><pre class="code-voice"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">} </font></font><span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch </font></font></span> <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pattern 2 </font></font></em> <span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where </font></font></span> <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">condition</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></pre></li><li><pre class="code-voice">    <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></em></pre></li><li><pre class="code-voice"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">} </font></font><span class="kt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">catch</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> {</font></font></pre></li><li><pre class="code-voice">    <em class="variable-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">声明</font></font></em></pre></li><li><pre class="code-voice"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">}</font></font></pre></li>
  </ul>
</div><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  你在之后编写一个模式</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来表明该子句可以处理的错误。</font><font style="vertical-align: inherit;">如果</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句没有模式，则子句会匹配任何错误并将错误绑定到名为的本地常量</font></font><code class="code-voice">error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">有关模式匹配的更多信息，请参阅</font></font><span class="x-name"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Patterns.html#//apple_ref/doc/uid/TP40014097-CH36-ID419" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH36-ID419"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模式</font></font></a></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  例如，以下代码与</font></font><code class="code-voice">VendingMachineError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举的</font><font style="vertical-align: inherit;">所有三种情况匹配</font><font style="vertical-align: inherit;">。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">var</span> <span class="vc">vendingMachine</span> = <span class="vc">VendingMachine</span>()</code></li>
            <li><code class="code-voice"><span class="vc">vendingMachine</span>.<span class="vc">coinsDeposited</span> = <span class="m">8</span></code></li>
            <li><code class="code-voice"><span class="kt">do</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">try</span> <span class="vc">buyFavoriteSnack</span>(<span class="vc">person</span>: <span class="s">"Alice"</span>, <span class="vc">vendingMachine</span>: <span class="vc">vendingMachine</span>)</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Success! Yum."</span>)</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> <span class="vc">VendingMachineError</span>.<span class="vc">invalidSelection</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Invalid Selection."</span>)</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> <span class="vc">VendingMachineError</span>.<span class="vc">outOfStock</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Out of Stock."</span>)</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> <span class="vc">VendingMachineError</span>.<span class="vc">insufficientFunds</span>(<span class="kt">let</span> <span class="vc">coinsNeeded</span>) {</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Insufficient funds. Please insert an additional </span>\(<span class="vc">coinsNeeded</span>)<span class="s"> coins."</span>)</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Unexpected error: </span>\(<span class="vc">error</span>)<span class="s">."</span>)</code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice"><span class="c">// Prints "Insufficient funds. Please insert an additional 2 coins."</span></code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在上面的例子中，</font></font><code class="code-voice">buyFavoriteSnack(person:vendingMachine:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数在</font></font><code class="code-voice">try</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式中</font><font style="vertical-align: inherit;">被调用</font><font style="vertical-align: inherit;">，因为它可能会引发错误。</font><font style="vertical-align: inherit;">如果发生错误，执行立即转移到</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句，决定是否允许继续传播。</font><font style="vertical-align: inherit;">如果没有模式匹配，则错误被最终</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">捕获</font><font style="vertical-align: inherit;">并且绑定到本地</font></font><code class="code-voice">error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常量。</font><font style="vertical-align: inherit;">如果没有错误发生，</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">则执行</font><font style="vertical-align: inherit;">语句中的其余语句</font><font style="vertical-align: inherit;">。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  这些</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句不必处理</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句</font><font style="vertical-align: inherit;">中的代码</font><font style="vertical-align: inherit;">可能抛出的</font><font style="vertical-align: inherit;">每一个可能的错误</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">如果没有任何</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">子句处理错误，则错误会传播到周围的范围。</font><font style="vertical-align: inherit;">然而，这个错误必须由</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一些</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">周围的范围</font><font style="vertical-align: inherit;">来处理</font><font style="vertical-align: inherit;">- 或者通过一个封闭的</font></font><code class="code-voice">do</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">处理错误的子句或者通过一个抛出函数来处理。</font><font style="vertical-align: inherit;">例如，上面的例子可以写成，所以任何不是a的错误都会被</font></font><code class="code-voice">VendingMachineError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用函数捕获：
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">nourish</span>(<span class="vc">with</span> <span class="vc">item</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span>) <span class="kt">throws</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">do</span> {</code></li>
            <li><code class="code-voice">        <span class="kt">try</span> <span class="vc">vendingMachine</span>.<span class="vc">vend</span>(<span class="vc">itemNamed</span>: <span class="vc">item</span>)</code></li>
            <li><code class="code-voice">    } <span class="kt">catch</span> <span class="kt">is</span> <span class="n"><!-- a href="" -->VendingMachineError<!-- /a --></span> {</code></li>
            <li><code class="code-voice">        <span class="vc">print</span>(<span class="s">"Invalid selection, out of stock, or not enough money."</span>)</code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice"><span class="kt">do</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">try</span> <span class="vc">nourish</span>(<span class="vc">with</span>: <span class="s">"Beet-Flavored Chips"</span>)</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">print</span>(<span class="s">"Unexpected non-vending-machine-related error: </span>\(<span class="vc">error</span>)<span class="s">"</span>)</code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice"><span class="c">// Prints "Invalid selection, out of stock, or not enough money."</span></code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  在该</font></font><code class="code-voice">nourish(with:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数中，如果</font></font><code class="code-voice">vend(itemNamed:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抛出错误（这是</font></font><code class="code-voice">VendingMachineError</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">枚举</font><font style="vertical-align: inherit;">的其中一种情况），则</font></font><code class="code-voice">nourish(with:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过打印消息来处理错误。</font><font style="vertical-align: inherit;">否则，</font></font><code class="code-voice">nourish(with:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将错误传播到其呼叫站点。</font><font style="vertical-align: inherit;">然后错误被通用</font></font><code class="code-voice">catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条款</font><font style="vertical-align: inherit;">捕获</font><font style="vertical-align: inherit;">。
</font></font></p>
  
</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID542"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将错误转换为可选值</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  您可以</font></font><code class="code-voice">try?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过将其转换为可选值来处理错误。</font><font style="vertical-align: inherit;">如果在评估</font></font><code class="code-voice">try?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表达式时</font><font style="vertical-align: inherit;">抛出错误，则</font><font style="vertical-align: inherit;">表达式的值为</font></font><code class="code-voice">nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，在下面的代码</font></font><code class="code-voice">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并</font></font><code class="code-voice">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">具有相同的价值和行为：
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">someThrowingFunction</span>() <span class="kt">throws</span> -&gt; <span class="n"><!-- a href="" -->Int<!-- /a --></span> {</code></li>
            <li><code class="code-voice">    <span class="c">// ...</span></code></li>
            <li><code class="code-voice">}</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice"><span class="kt">let</span> <span class="vc">x</span> = <span class="kt">try</span>? <span class="vc">someThrowingFunction</span>()</code></li>
            <li><code class="code-voice"> </code></li>
            <li><code class="code-voice"><span class="kt">let</span> <span class="vc">y</span>: <span class="n"><!-- a href="" -->Int<!-- /a --></span>?</code></li>
            <li><code class="code-voice"><span class="kt">do</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">y</span> = <span class="kt">try</span> <span class="vc">someThrowingFunction</span>()</code></li>
            <li><code class="code-voice">} <span class="kt">catch</span> {</code></li>
            <li><code class="code-voice">    <span class="vc">y</span> = <span class="kt">nil</span></code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  如果</font></font><code class="code-voice">someThrowingFunction()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">抛出一个错误，价值</font></font><code class="code-voice">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="code-voice">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为</font></font><code class="code-voice">nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">否则，</font></font><code class="code-voice">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="code-voice">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的值就是函数返回的值。</font><font style="vertical-align: inherit;">请注意，</font></font><code class="code-voice">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并且</font></font><code class="code-voice">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是任何类型</font></font><code class="code-voice">someThrowingFunction()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">返回</font><font style="vertical-align: inherit;">的可选项</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">在这里，函数返回一个整数，所以</font></font><code class="code-voice">x</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><code class="code-voice">y</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">是可选的整数。
</font></font></p><p class="para"><font style="vertical-align: inherit;"></font><code class="code-voice">try?</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当您想以相同的方式处理所有错误时，</font><font style="vertical-align: inherit;">
  Using </font><font style="vertical-align: inherit;">使您可以编写简洁的错误处理代码。</font><font style="vertical-align: inherit;">例如，以下代码使用多种方法来获取数据，或者</font></font><code class="code-voice">nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果所有方法都失败</font><font style="vertical-align: inherit;">，则返回</font><font style="vertical-align: inherit;">。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">fetchData</span>() -&gt; <span class="n"><!-- a href="" -->Data<!-- /a --></span>? {</code></li>
            <li><code class="code-voice">    <span class="kt">if</span> <span class="kt">let</span> <span class="vc">data</span> = <span class="kt">try</span>? <span class="vc">fetchDataFromDisk</span>() { <span class="kt">return</span> <span class="vc">data</span> }</code></li>
            <li><code class="code-voice">    <span class="kt">if</span> <span class="kt">let</span> <span class="vc">data</span> = <span class="kt">try</span>? <span class="vc">fetchDataFromServer</span>() { <span class="kt">return</span> <span class="vc">data</span> }</code></li>
            <li><code class="code-voice">    <span class="kt">return</span> <span class="kt">nil</span></code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID513"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">禁用错误传播</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  有时你知道抛出函数或方法实际上不会在运行时抛出错误。</font><font style="vertical-align: inherit;">在这些情况下，您可以</font></font><code class="code-voice">try!</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在表达式之前</font><font style="vertical-align: inherit;">编写代码</font><font style="vertical-align: inherit;">以禁用错误传播，并将调用包装在运行时断言中，以避免引发错误。</font><font style="vertical-align: inherit;">如果实际发生错误，则会出现运行时错误。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  例如，下面的代码使用一个</font></font><code class="code-voice">loadImage(atPath:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数，该函数将图像资源加载到给定的路径，或者在图像无法加载时引发错误。</font><font style="vertical-align: inherit;">在这种情况下，因为图像随应用程序一起提供，所以在运行时不会发生错误，所以适当地禁用错误传播。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">let</span> <span class="vc">photo</span> = <span class="kt">try</span>! <span class="vc">loadImage</span>(<span class="vc">atPath</span>: <span class="s">"./Resources/John Appleseed.jpg"</span>)</code></li>
        </ol>
      </div>
  </div>
</section>
  
</section>

</section>
<section class="section">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-ID514"></a>
  <h3 class="section-name" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定清理操作</font></font></h3>
  <p class="para"><font style="vertical-align: inherit;"></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在代码执行离开当前代码块之前，</font><font style="vertical-align: inherit;">
  您使用</font><font style="vertical-align: inherit;">语句来执行一组语句。</font><font style="vertical-align: inherit;">这个语句可以让你做任何必要的清理工作，不管</font><font style="vertical-align: inherit;">执行</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如何</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">离开当前的代码块 - 无论它是因为抛出错误还是因为诸如</font></font><code class="code-voice">return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">or </font><font style="vertical-align: inherit;">的语句而离开</font></font><code class="code-voice">break</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">例如，您可以使用</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来确保关闭文件描述符并释放手动分配的内存。
</font></font></p><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  一</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">直到当前范围退出声明推迟执行。</font><font style="vertical-align: inherit;">该语句由</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关键字和稍后要执行的</font><font style="vertical-align: inherit;">语句组成</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">延迟语句可能不包含任何将控制从语句中移出的代码，例如a </font></font><code class="code-voice">break</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code class="code-voice">return</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句，或者抛出错误。</font><font style="vertical-align: inherit;">延迟操作的执行顺序与它们写入源代码的顺序相反。</font><font style="vertical-align: inherit;">也就是说，第一个</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中的代码最后执行，第二个</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句中</font><font style="vertical-align: inherit;">的代码执行倒数</font><font style="vertical-align: inherit;">第二个，依此类推。</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源代码顺序中</font><font style="vertical-align: inherit;">的最后一条</font><font style="vertical-align: inherit;">语句首先执行。
</font></font></p><section class="code-listing">
  
  <div class="code-sample">
      <div class="Swift">
        <ol class="code-lines">
            <li><code class="code-voice"><span class="kt">func</span> <span class="vc">processFile</span>(<span class="vc">filename</span>: <span class="n"><!-- a href="" -->String<!-- /a --></span>) <span class="kt">throws</span> {</code></li>
            <li><code class="code-voice">    <span class="kt">if</span> <span class="vc">exists</span>(<span class="vc">filename</span>) {</code></li>
            <li><code class="code-voice">        <span class="kt">let</span> <span class="vc">file</span> = <span class="vc">open</span>(<span class="vc">filename</span>)</code></li>
            <li><code class="code-voice">        <span class="kt">defer</span> {</code></li>
            <li><code class="code-voice">            <span class="vc">close</span>(<span class="vc">file</span>)</code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        <span class="kt">while</span> <span class="kt">let</span> <span class="vc">line</span> = <span class="kt">try</span> <span class="vc">file</span>.<span class="vc">readline</span>() {</code></li>
            <li><code class="code-voice">            <span class="c">// Work with the file.</span></code></li>
            <li><code class="code-voice">        }</code></li>
            <li><code class="code-voice">        <span class="c">// close(file) is called here, at the end of the scope.</span></code></li>
            <li><code class="code-voice">    }</code></li>
            <li><code class="code-voice">}</code></li>
        </ol>
      </div>
  </div>
</section><p class="para"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
  上面的例子使用一个</font></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语句来确保</font></font><code class="code-voice">open(_:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">函数有相应的调用</font></font><code class="code-voice">close(_:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。
</font></font></p><div class="note">
  <a name="//apple_ref/doc/uid/TP40014097-CH42-NoLink_157"></a>
  <aside class="aside">
    <p class="aside-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意
    </font></font></p>
    	<p class="para"><font style="vertical-align: inherit;"></font><code class="code-voice">defer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">即使没有涉及错误处理代码，也</font><font style="vertical-align: inherit;">可以使用</font><font style="vertical-align: inherit;">语句。
    	</font></font></p>
    
  </aside>
</div>
  
</section>

  	
 	<section id="next_previous" class="">
    		<p class="previous-link"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/OptionalChaining.html#//apple_ref/doc/uid/TP40014097-CH21-ID245" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH21-ID245"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可选链接</font></font></a></p>
  			<p class="next-link"><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/TypeCasting.html#//apple_ref/doc/uid/TP40014097-CH22-ID338" data-renderer-version="2" data-id="//apple_ref/doc/uid/TP40014097-CH22-ID338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类型铸造</font></font></a></p>

    <p class="copyright"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copyright©2018 Apple Inc.保留所有权利。 
  </font></font><a class="link" href="http://www.apple.com/legal/terms/site.html" target="_blank" rel="external"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用条款</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | 
  </font></font><a class="link" href="http://www.apple.com/privacy/" target="_blank" rel="external"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隐私政策</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font><font style="vertical-align: inherit;">更新日期：2018-02-20
</font></font></p>
  </section>
</article>

    </div>
    <div id="big_button"></div>
    <footer id="footer">
  <div class="content-wrapper">
  	<div id="leave_feedback" class="button" role="button" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">反馈</font></font></div>
  </div>
  <script src="./The Swift Programming Language (Swift 4.1)_错误处理_files/devpubs-1.6.3.js" type="text/javascript" charset="utf-8"></script>
  <script src="./The Swift Programming Language (Swift 4.1)_错误处理_files/feedback-1.6.3.js" type="text/javascript" charset="utf-8"></script>
  <div id="_omniture_top">
<!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
<script type="text/javascript">
/* RSID: */
var s_account="appleglobal,appleusdeveloper,dappdeveloperlib"
</script>

<script type="text/javascript" src="./The Swift Programming Language (Swift 4.1)_错误处理_files/s_code_h.js"></script>
<script type="text/javascript">
s.pageName=AC.Tracking.pageName();
s.channel="www.us.developer"

/************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
var s_code=s.t();if(s_code)document.write(s_code)</script>
<!-- End SiteCatalyst code version: H.8. -->
</div>

</footer>

    
  
    <div id="blackout">
    <div id="preload"></div>
</div>
<div id="modal" aria-hidden="true">
    <div id="closebox" tabindex="0" aria-label="Close feedback form" role="button"></div>
    <div id="sending" class="hidden">
        <h2 tabindex="0">Sending feedback…</h2>
        <div id="sending_img"></div>
    </div>
    <div id="error" class="hidden">
        <h2 tabindex="0">We’re sorry, an error has occurred.</h2>
        <p>Please try submitting your feedback later.</p>
        <div id="error_icon"></div>
    </div>
    <div id="success" class="hidden">
        <h2 tabindex="0">Thank you for providing feedback!</h2>
        <p>Your input helps improve our developer documentation.</p>
        <div id="thank_you_icon"></div>
    </div>
    
    <form id="feedback" action="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/ErrorHandling.html#" method="post">
        <div class="left-leaf">
            <h2 id="helpful_title" data-asterisk="a1" tabindex="0"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这份文件有多大帮助？</font></font></h2>     
            <sup id="a1" class="asterisk" aria-hidden="true"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup>

            <div id="star_group" role="radiogroup" aria-required="true">
                <label> 
                    <input class="radio" type="radio" name="helped" value="1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    很有帮助
                </font></font></label>
                <label> 
                    <input class="radio" type="radio" name="helped" value="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    有点帮助
                </font></font></label>
                <label>
                    <input class="radio" type="radio" name="helped" value="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    没有帮助
                </font></font></label>
            </div>
        </div>
        <div class="right-leaf">
            <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们如何改进这个文件？</font></font></h2>
            <div id="improve" class="checkboxes">
                <label>
                    <input type="checkbox" name="typo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    修正错别字或链接
                </font></font></label>
                <label>
                    <input type="checkbox" name="infoIncorrect"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    修正错误的信息
                </font></font></label>
                <label>
                    <input type="checkbox" name="needs_examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    添加或更新代码示例
                </font></font></label>
                <label>
                    <input type="checkbox" name="needs_art"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    添加或更新插图
                </font></font></label>
                <label>
                    <input type="checkbox" name="missingInfo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
                    添加有关...的信息
                </font></font></label>
            </div>
        </div>

        <textarea id="comment" name="problem" cols="70" rows="8" placeholder="Please tell us more about your experience with this document" data-asterisk="a2" required=""></textarea>
        <sup id="a2" class="asterisk" aria-hidden="true"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup>

        <p class="fineprint">
            <em aria-hidden="true"><span>*</span> Required information</em>
        </p> 

        <input id="submit" type="button" value="Send">

        <section id="legal">
            <p>
                To submit a product bug or enhancement request, please visit the 
                <a href="https://developer.apple.com/bugreporter/" target="_blank">Bug Reporter</a> 
                page.
            </p>
            <p>
                Please read <a href="http://www.apple.com/legal/policies/ideas.html" target="_blank">Apple's Unsolicited Idea Submission Policy</a> 
                before you send us your feedback.
            </p> 
        </section>
    </form>
</div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./The Swift Programming Language (Swift 4.1)_错误处理_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>



<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>